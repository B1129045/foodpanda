<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Foodpanda 模擬結帳頁面</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            background-color: #f7f7f7;
        }

        h2 {
            color: #333;
        }

        #checkout-page {
            max-width: 600px;
            margin: 30px auto;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        #checkout-summary {
            margin-bottom: 20px;
        }

        .item-row {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }

        .item-name {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .item-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 5px;
        }

        .item-controls button {
            width: 30px;
            height: 30px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f1f1f1;
            cursor: pointer;
        }

        .item-controls button:hover {
            background-color: #e6e6e6;
        }

        .item-price {
            font-size: 14px;
            color: #555;
        }

        #cart-total {
            text-align: right;
            font-size: 18px;
            font-weight: bold;
        }

        #checkout-form label {
            display: block;
            margin: 10px 0 5px;
            font-weight: bold;
        }

        #checkout-form input,
        #checkout-form select {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        #checkout-form button {
            width: 100%;
            padding: 15px;
            background-color: #ff5a5f;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 10px;
        }

        #checkout-form button:hover {
            background-color: #e0484c;
        }
    </style>
</head>

<body>
    <div id="checkout-page">
        <h2>結帳</h2>

        <!-- 訂購商品摘要 -->
        <div id="checkout-summary">
            <h3>訂購商品</h3>
            <div id="cart-summary-items">
                <!-- 這裡會顯示訂購商品 -->
            </div>
            <div id="cart-total">
                總金額: <strong>0 元</strong>
            </div>
        </div>

        <!-- 表單開始 -->
        <form id="checkout-form">
            <label for="address">送餐地址</label>
            <input type="text" id="address" name="address" placeholder="請輸入送餐地址" required>

            <label for="payment-method">付款方式</label>
            <select id="payment-method" name="payment-method" required>
                <option value="credit-card">信用卡</option>
                <option value="cash">貨到付款</option>
                <option value="line-pay">LINE Pay</option>
            </select>

            <label for="name">姓名</label>
            <input type="text" id="name" name="name" required>

            <label for="phone">電話</label>
            <input type="tel" id="phone" name="phone" required>

            <button type="submit">確認訂單</button>
        </form>
    </div>

    <script>
        let cart = JSON.parse(localStorage.getItem('cart')) || [];

        // 渲染訂購商品摘要
        function renderCartSummary() {
            const summaryContainer = document.getElementById('cart-summary-items');
            const totalRow = document.getElementById('cart-total');
            let totalPrice = 0;

            summaryContainer.innerHTML = ''; // 清空舊內容

            cart.forEach((item, index) => {
                const itemRow = document.createElement('div');
                itemRow.className = 'item-row';
                itemRow.innerHTML = `
                    <div class="item-name">${item.name}</div>
                    <div class="item-controls">
                        <button class="decrease-btn" data-index="${index}">-</button>
                        <span>${item.quantity}</span>
                        <button class="increase-btn" data-index="${index}">+</button>
                    </div>
                    <div class="item-price">${item.price * item.quantity} 元</div>
                `;
                summaryContainer.appendChild(itemRow);
                totalPrice += item.price * item.quantity;
            });

            totalRow.innerHTML = `總金額: <strong>${totalPrice} 元</strong>`;
        }

        // 更新數量
        function updateQuantity(index, delta) {
            cart[index].quantity += delta;
            if (cart[index].quantity < 1) {
                cart.splice(index, 1); // 如果數量少於 1，移除該項目
            }
            localStorage.setItem('cart', JSON.stringify(cart));
            renderCartSummary();
        }

        // 綁定按鈕事件
        document.getElementById('cart-summary-items').addEventListener('click', (event) => {
            const index = event.target.dataset.index;
            if (event.target.classList.contains('increase-btn')) {
                updateQuantity(index, 1);
            } else if (event.target.classList.contains('decrease-btn')) {
                updateQuantity(index, -1);
            }
        });

        // 提交訂單
        document.getElementById('checkout-form').addEventListener('submit', (event) => {
            event.preventDefault();
            const address = document.getElementById('address').value;
            const paymentMethod = document.getElementById('payment-method').value;
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;

            const orderDetails = {
                cart,
                address,
                paymentMethod,
                customerInfo: { name, phone },
            };

            console.log('訂單內容:', orderDetails);
            alert('訂單提交成功！謝謝您的購買！');

            cart = [];
            localStorage.removeItem('cart');
            renderCartSummary();
        });

        // 初始化頁面
        renderCartSummary();
    </script>
</body>

</html>
